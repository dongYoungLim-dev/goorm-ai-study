"""
문제 3: Plotly Statistics Chart

목표: 통계 차트를 사용하여 데이터의 분포를 시각화하기
"""

import plotly.graph_objects as go
from plotly.subplots import make_subplots

# ============================================================================
# 데이터 준비
# ============================================================================
# Category별 Sales 개별 값들 (각 카테고리별 200개 샘플)
# 이 데이터를 사용하는 이유:
# - 통계 차트(박스 플롯, 바이올린 플롯, 히스토그램)는 개별 데이터 포인트의
#   분포를 보여주기 위해 집계된 합계가 아닌 원시 데이터가 필요합니다
# - 각 Category별로 충분한 수의 샘플(200개)을 포함하여 분포의 특성을
#   명확하게 시각화할 수 있습니다
# - Furniture, Office Supplies, Technology 세 카테고리의 분포를 비교하여
#   각 카테고리의 Sales 패턴 차이를 분석할 수 있습니다
category_sales_data = {
    'Furniture': [20.104, 205.3328, 213.216, 30.192, 172.186, 225.296, 269.97, 35.92, 239.372, 9.94, 42.6, 37.68, 246.1328, 127.869, 1403.92, 241.568, 7.584, 526.344, 82.38, 4.712, 664.146, 787.53, 24.368, 512.499, 564.195, 411.332, 3.984, 332.028, 8.8, 141.96, 207.0, 43.13, 409.59, 205.164, 266.352, 164.22, 186.048, 121.78, 14.272, 347.802, 782.94, 72.784, 363.92, 523.764, 899.136, 22.2, 418.296, 638.82, 1044.63, 36.4, 8.752, 6.984, 135.3, 44.46, 24.14, 14.76, 156.3728, 340.116, 66.645, 128.82, 43.13, 22.848, 16.74, 313.176, 187.056, 2.784, 47.04, 447.84, 171.288, 88.02, 42.408, 154.95, 966.7, 61.96, 160.98, 340.704, 81.94, 4297.644, 441.96, 70.68, 214.11, 362.94, 975.92, 498.26, 69.375, 167.888, 892.136, 129.39, 299.97, 477.666, 4.656, 393.165, 139.92, 18.96, 120.666, 227.96, 254.9745, 14.56, 13.592, 14.82, 48.712, 161.568, 122.352, 715.2, 117.36, 27.46, 171.288, 379.372, 89.99, 353.568, 579.528, 133.38, 323.136, 1603.136, 97.184, 242.352, 957.5775, 14.73, 3785.292, 1043.92, 108.608, 1685.88, 33.11, 302.94, 8.352, 56.568, 21.88, 64.784, 145.568, 1137.75, 173.94, 120.98, 528.43, 136.464, 2036.86, 120.784, 1424.9, 2888.127, 872.94, 8.544, 9.96, 517.405, 54.712, 2404.704, 24.1, 6.696, 209.88, 113.568, 89.34, 617.7, 239.98, 109.48, 23.99, 51.072, 45.696, 13.28, 272.94, 3.312, 41.568, 482.664, 41.568, 5.344, 6.464, 301.47, 16.192, 563.43, 727.45, 174.0585, 354.9, 1913.4, 449.568, 206.352, 135.8, 168.464, 15.4, 854.352, 550.431, 199.304, 22.608, 183.372, 2003.52, 130.98, 195.466, 801.96, 239.358, 897.15, 121.376, 51.264, 462.564, 1090.782, 1038.84, 40.784, 579.136, 39.88, 337.176, 317.058, 183.92, 1604.9, 17.088, 195.184],
    'Office Supplies': [167.292, 7.968, 3.264, 332.94, 27.096, 119.04, 52.096, 48.944, 5.904, 15.14, 92.52, 17.64, 8.34, 324.9, 25.92, 80.88, 43.7, 43.176, 154.9, 400.8, 37.44, 10.688, 143.96, 33.4, 715.64, 99.87, 9.96, 9.912, 46.84, 32.07, 5.344, 120.15, 37.608, 29.718, 61.4, 14.592, 99.588, 31.104, 11.232, 3.75, 286.256, 20.88, 58.05, 2.655, 10.824, 16.24, 1.192, 11.12, 12.672, 14.76, 10.43, 38.88, 11.16, 45.36, 34.384, 22.05, 807.75, 47.98, 324.9, 31.776, 20.736, 28.752, 2.808, 1.696, 221.024, 26.7, 14.088, 27.968, 78.304, 70.95, 27.86, 325.632, 19.68, 2715.93, 49.76, 32.4, 62.04, 368.91, 11.68, 447.696, 1.234, 18.06, 38.19, 895.92, 24.192, 176.772, 184.66, 26.032, 31.104, 58.924, 7.23, 75.96, 15.552, 12.176, 20.952, 13.904, 6.48, 5.607, 15.552, 111.96, 2.502, 2.48, 12.88, 66.54, 991.2, 72.784, 20.23, 268.576, 24.88, 481.32, 146.73, 39.68, 465.18, 67.9, 5.94, 262.24, 18.588, 38.82, 7.38, 27.396, 841.568, 21.168, 15.26, 361.96, 19.536, 27.396, 1577.94, 19.752, 30.56, 34.24, 195.136, 542.94, 38.256, 35.44, 200.064, 15.552, 542.94, 17.568, 54.336, 2.376, 12.42, 32.4, 609.98, 11.364, 4.419, 242.9, 19.92, 344.91, 26.352, 1295.78, 44.856, 2690.97, 32.088, 5.46, 19.44, 122.97, 25.344, 122.97, 19.6, 105.52, 122.12, 931.176, 44.4, 32.75, 12.96, 7.56, 5.68, 16.27, 37.94, 99.9, 17.94, 213.136, 149.544, 9.296, 3.68, 58.73, 10.752, 8.39, 21.594, 15.7, 76.12, 947.17, 15.552, 31.68, 5.04, 20.724, 78.304, 122.71, 143.856, 29.2, 720.064, 32.4, 62.376, 61.06, 11.264, 16.0, 11.56, 56.784, 12.96, 333.09],
    'Technology': [255.984, 63.992, 79.96, 67.8, 112.8, 89.97, 431.976, 1199.976, 431.928, 371.976, 89.988, 879.984, 41.94, 239.984, 471.92, 9.588, 39.264, 263.96, 98.16, 98.16, 62.958, 47.976, 9.09, 3404.5, 90.57, 32.985, 52.68, 2548.56, 23.472, 120.0, 111.98, 743.988, 2249.91, 881.93, 47.984, 383.952, 49.98, 156.792, 1169.694, 55.984, 23.84, 7.992, 104.85, 52.792, 248.85, 112.776, 1287.45, 1415.76, 818.376, 287.968, 361.376, 1039.728, 107.984, 383.84, 239.97, 23.988, 863.928, 35.36, 159.96, 63.824, 59.97, 177.48, 20.7, 587.97, 36.24, 54.384, 2279.96, 2.376, 907.152, 47.984, 65.99, 36.51, 39.594, 53.04, 158.376, 149.95, 6.9, 66.3, 431.976, 773.94, 19.04, 57.36, 59.9, 139.96, 13.98, 307.98, 31.86, 357.0, 302.376, 843.9, 543.92, 26.0, 899.91, 99.98, 36.0, 37.056, 178.92, 95.984, 108.768, 62.352, 1349.85, 164.792, 1799.75, 479.94, 485.94, 45.894, 2519.958, 7.992, 1919.976, 329.584, 45.12, 1071.0, 998.85, 207.0, 10.312, 302.384, 59.98, 177.48, 3999.95, 271.9, 43.6, 629.95, 2479.96, 95.84, 22638.48, 132.52, 72.0, 625.99, 30.0, 45.0, 26.982, 499.168, 258.696, 47.79, 837.6, 95.1, 95.968, 30.84, 431.16, 68.112, 43.6, 979.95, 29.97, 377.97, 629.95, 183.96, 16.776, 31.968, 50.12, 569.64, 683.988, 88.776, 19.8, 34.95, 46.688, 689.408, 12.585, 35.184, 499.95, 783.96, 159.98, 1502.376, 62.4, 158.376, 31.176, 31.95, 716.0, 302.376, 25.488, 359.97, 199.95, 122.328, 671.93, 453.576, 11.56, 599.99, 31.984, 479.988, 29.99, 140.736, 467.04, 239.97, 519.792, 826.62, 587.97, 360.0, 104.88, 655.9, 69.98, 83.72, 21.48, 58.58, 71.0, 539.97, 35.12, 13.616, 24.0, 1115.91, 99.39, 167.944],
}

# 전체 Sales 데이터 (히스토그램용)
# 모든 카테고리의 Sales 값을 하나의 리스트로 합침
all_sales = []
for category, sales_list in category_sales_data.items():
    all_sales.extend(sales_list)

# ============================================================================
# 차트 생성
# ============================================================================
# TODO: 여기에 코드를 작성하세요
# 1. make_subplots를 사용하여 2행 1열 subplot 생성
#    - 첫 번째 subplot: 박스 플롯과 바이올린 플롯 (같은 위치에 겹쳐서)
#    - 두 번째 subplot: 히스토그램
# 2. 박스 플롯 생성: Category별 Sales 분포
# 3. 바이올린 플롯 생성: Category별 Sales 분포 (박스 플롯과 같은 subplot)
# 4. 히스토그램 생성: 전체 Sales 분포
# 5. 각 차트에 제목, 축 레이블 추가


fig = make_subplots(rows=2, cols=1, subplot_titles=('Category별 Sales 분포', '전체 Sales 분포'))

for category, sales_list in category_sales_data.items():
  fig.add_trace(go.Box(y=sales_list, name=category), row=1, col=1)
  fig.add_trace(go.Violin(y=sales_list, name=category), row=1, col=1)
  fig.add_trace(go.Histogram(x=sales_list, name=category), row=2, col=1)

fig.update_yaxes(range=[0, 5000], row=1, col=1)
fig.update_xaxes(range=[0, 3000], row=2, col=1)
fig.update_yaxes(range=[0, 200], row=2, col=1)

fig.update_layout(title_text="Category별 Sales 통계 분석")
fig.update_xaxes(title_text="Sales", row=1, col=1)
fig.update_yaxes(title_text="Category", row=1, col=1)
fig.update_xaxes(title_text="Sales", row=2, col=1)
fig.update_yaxes(title_text="빈도", row=2, col=1)

fig.show()





# 힌트:
# - fig = make_subplots(rows=2, cols=1, ...)로 subplot 생성
# - go.Box()로 박스 플롯 생성 (x=카테고리명 리스트, y=Sales 값 리스트)
# - go.Violin()로 바이올린 플롯 생성
# - go.Histogram()로 히스토그램 생성 (x=all_sales)
# - fig.add_trace(..., row=1, col=1)로 첫 번째 subplot에 추가
# - fig.add_trace(..., row=2, col=1)로 두 번째 subplot에 추가
# - fig.update_xaxes(), fig.update_yaxes()로 축 레이블 설정
# - fig.update_layout()로 전체 제목 설정

# 예시 코드 구조:
# fig = make_subplots(
#     rows=2, cols=1,
#     subplot_titles=('Category별 Sales 분포', '전체 Sales 분포'),
#     vertical_spacing=0.15
# )
# 
# # 박스 플롯
# for category, sales_list in category_sales_data.items():
#     fig.add_trace(go.Box(y=sales_list, name=category, ...), row=1, col=1)
# 
# # 바이올린 플롯 (선택사항 - 박스 플롯과 함께 표시)
# # 또는 별도로 생성
# 
# # 히스토그램
# fig.add_trace(go.Histogram(x=all_sales, ...), row=2, col=1)
# 
# fig.update_layout(title_text="Category별 Sales 통계 분석", ...)
# fig.update_xaxes(title_text="Category", row=1, col=1)
# fig.update_yaxes(title_text="Sales", row=1, col=1)
# fig.update_xaxes(title_text="Sales", row=2, col=1)
# fig.update_yaxes(title_text="빈도", row=2, col=1)

# ============================================================================
# 결과 저장
# ============================================================================
# fig.write_html('result3_statistics.html')
# fig.show()
